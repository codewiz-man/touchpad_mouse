<!DOCTYPE html>
<html>
<head>
    <style>
        html {
            margin: 0; padding: 0;
        }
        body {
            margin: 0;
            min-width: 600px; min-height: 600px; font-family: Arial, Helvetica, sans-serif;
        }
        .C_container {
            width: 100vw; height: 100vh; background-color: #f0f0f0; position: relative;
            color: #323232; overflow-y: auto;      
        }
        .C_left {
            width: 50%; float: left; min-width: 300px;
        }
        .C_right {
            width: 50%; float: left;  min-width: 300px;
        }
        input[type=text], input[type=number], input[type=email], input[type=password] {
            outline: none;
            border: none;
            padding: 15px 10px;
            width: calc(100% - 40px);
            margin: 5px 5px;
            border-bottom: 1px solid #e0e0e0;
            max-width: 350px;
        }

        input[type=text]:disabled, input[type=number]:disabled, input[type=email]:disabled, input[type=password]:disabled { 
            opacity: 0.5;
        }

        .C_button, .C_button_large {
            display: inline-block;
            width: auto;
            height: auto;
            overflow: hidden;
            color: #fff;
            background-color: #04AA6D;
            cursor: pointer;
            padding: 12px 15px;
            border-radius: 3px;
            letter-spacing: .5px;
            font-size: 90%;
            margin: 5px;
            border: none;
        }

        .C_button_large {
            width: calc(100% - 20px);
            max-width: 350px;
            text-align: center;
        }

        .C_button:disabled, .C_button_large:disabled {
            opacity: .5;
        }
        .C_button:hover, .C_button:active, .C_button_large:hover, .C_button_large:active {
            filter: brightness(1.15);
        }
        .C_config-container {
            width: 75%;
            height: 100%;
            margin: auto;
            margin-top: 100px;
            position: relative;
        }
        .C_config-head {
            width: 100%;
            font-size: 20px; font-weight: bold; text-align: center;
            padding: 30px 0;
        }
        .C_qrcode {
            width: 250px; height: 250px; position: relative; margin: auto; margin-top: 150px; margin-left: 50px;
        }
    </style>
    <title>Touchpad Server</title>
</head>
<body id="id_body">

    <div class="C_container">
        <div class="C_left"> 
            <div class="C_config-container">
                <div class="C_config-head">
                    Settings
                </div>
                <!-- Input fields for server address and port -->
                <div>
                    <input type="text" placeholder="Server Address" id="id_server_address" disabled>
                </div>
                <div>
                    <input type="text" placeholder="Server Port" id="id_server_port" value="2023">
                </div>
                <!-- Button to save settings -->
                <button class="C_button_large" id="id_save_setting"> save </button>
            </div>
        </div>
        <div class="C_right">
            <div> 
                <!-- QR code image -->
                <img class="C_qrcode" id="id_qrcode" src="qrcode.png">
            </div>
        </div>
    </div>
    
    </body>
    <script>
        /* JavaScript code */
        
        // Event listener for when the webview is ready
        window.addEventListener('pywebviewready', function() {
            // Get references to server address and port input elements
            var server_ip = document.getElementById('id_server_address');
            var server_port = document.getElementById('id_server_port');
            
            // Call the Python API to get server IP and port
            pywebview.api.get_server_ip().then(function(res){
                console.log(res);
                // Populate the input fields with retrieved values
                server_ip.value = res[0];
                server_port.value = res[1];
            });
    
            // Event listener for saving settings button
            document.getElementById('id_save_setting').onclick = function(){
                // Get the server port value
                const port = document.getElementById("id_server_port").value;
                if( (port == undefined) || (port == "" ) ){
                    alert("Enter Valid Server Port Number");
                    return;
                }
                
                // Call the Python API to save server IP and port
                pywebview.api.save_server_ip(port).then(function(res) {
                    if(res) {
                        alert("Saved Successfully.\nClose and Reopen the App to See the Changes");
                    } else {
                        alert("Settings Not Saved");
                    }
                    console.log(res);
                });
            };
        })
    </script>
    </html>